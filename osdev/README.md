# OCap OS Dev Exploration with VirtualBox

This directory contains tools to create a VirtualBox VM that boots from a physical disk, for operating system development experiments.

## Setup

1.  **Edit Makefile**: Open `Makefile` and set `TARGET_DISK` to your raw disk device (e.g., `/dev/sdc`). **BE VERY CAREFUL** as subsequent steps can wipe this disk. Also set `VM_NAME` to the name of your VirtualBox VM.

2.  **Set Permissions**: Grant your user access to raw disks.
    ```sh
    make perms
    ```
    Then, **log out and log back in** for the group change to take effect.

3.  **Create VMDK**: Generate the `.vmdk` file that points to the physical disk.
    ```sh
    make physical.vmdk
    ```

4.  **Create VirtualBox VM**:
    -   Open VirtualBox.
    -   Create a new VM (the name must match `VM_NAME` from the `Makefile`).
    -   When asked for a Hard Disk, select "Use an existing virtual hard disk file" and choose `osdev/physical.vmdk`.
    -   Ensure EFI is enabled in the VM settings if you're booting an EFI system.

5.  **Provision Disk (Optional & DESTRUCTIVE)**: If the disk is empty, you can partition and format it using the Makefile's destructive targets. **THIS WILL WIPE THE DISK.**
    ```sh
    # Example for partitioning and formatting
    sudo make partition-disk
    sudo make format-disk
    ```

6.  **Run**:
    ```sh
    make run
    ```

## Files

-   `README.md`: This file.
-   `Makefile`: Automation for setup and management.
-   `physical.vmdk`: A placeholder file. The real file is generated by `make physical.vmdk` and points VirtualBox to a raw physical disk.
